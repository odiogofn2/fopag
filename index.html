<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle Financeiro</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #1e3c72, #2a5298);
  padding: 20px;
}

.container {
  max-width: 700px;
  margin: auto;
}

h1 {
  text-align: center;
  color: white;
}

.card {
  background: white;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 15px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.15);
}

.saldo {
  font-size: 22px;
  text-align: center;
  font-weight: bold;
}

label {
  display: block;
  margin-top: 10px;
  font-weight: bold;
}

input, select, button {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

button {
  background: #2a5298;
  color: white;
  border: none;
  cursor: pointer;
  margin-top: 12px;
}

button:hover {
  opacity: 0.9;
}

.lancamento {
  border-left: 6px solid;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 6px;
}

.entrada { border-color: green; }
.saida { border-color: red; }

.acoes {
  display: flex;
  gap: 10px;
  margin-top: 8px;
}

.acoes button {
  flex: 1;
  font-size: 12px;
}
</style>
</head>

<body>
<div class="container">

<h1>üí∞ Controle Financeiro</h1>

<div class="card">
  <div class="saldo" id="saldo">Saldo: R$ 0,00</div>
</div>

<div class="card">
  <input type="hidden" id="editandoId">

  <label>Tipo</label>
  <select id="tipo">
    <option value="entrada">Entrada</option>
    <option value="saida">Sa√≠da</option>
  </select>

  <label>Valor (R$)</label>
  <input type="number" id="valor" step="0.01">

  <label>Descri√ß√£o</label>
  <input type="text" id="descricao">

  <button onclick="salvarLancamento()">Salvar</button>
</div>

<div class="card">
  <h3>Lan√ßamentos</h3>
  <div id="lista"></div>
</div>

</div>

<script>
let lancamentos = JSON.parse(localStorage.getItem("lancamentos")) || [];

function gerarId() {
  return Date.now() + Math.random().toString(16).slice(2);
}

function salvarStorage() {
  localStorage.setItem("lancamentos", JSON.stringify(lancamentos));
}

function formatar(valor) {
  return valor.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
}

function salvarLancamento() {
  const tipo = tipoInput.value;
  const valor = parseFloat(valorInput.value);
  const descricao = descricaoInput.value;
  const editandoId = document.getElementById("editandoId").value;

  if (!valor || !descricao) {
    alert("Preencha todos os campos");
    return;
  }

  if (editandoId) {
    const l = lancamentos.find(x => x.id === editandoId);
    l.tipo = tipo;
    l.valor = valor;
    l.descricao = descricao;
  } else {
    lancamentos.unshift({
      id: gerarId(),
      tipo,
      valor,
      descricao,
      data: new Date().toLocaleString("pt-BR", { timeZone: "America/Sao_Paulo" }),

      // BASE PARA PARCELAS
      parcelado: false,
      totalParcelas: 1,
      parcelaAtual: 1,
      grupoParcelamentoId: null
    });
  }

  document.getElementById("editandoId").value = "";
  valorInput.value = "";
  descricaoInput.value = "";

  salvarStorage();
  atualizarTela();
}

function editar(id) {
  const l = lancamentos.find(x => x.id === id);
  tipoInput.value = l.tipo;
  valorInput.value = l.valor;
  descricaoInput.value = l.descricao;
  document.getElementById("editandoId").value = id;
}

function excluir(id) {
  if (!confirm("Excluir lan√ßamento?")) return;
  lancamentos = lancamentos.filter(l => l.id !== id);
  salvarStorage();
  atualizarTela();
}

function atualizarTela() {
  lista.innerHTML = "";
  let saldo = 0;

  lancamentos.forEach(l => {
    saldo += l.tipo === "entrada" ? l.valor : -l.valor;

    const div = document.createElement("div");
    div.className = `lancamento ${l.tipo}`;
    div.innerHTML = `
      <strong>${l.descricao}</strong><br>
      ${l.data}<br>
      ${l.tipo === "entrada" ? "+" : "-"} ${formatar(l.valor)}
      <div class="acoes">
        <button onclick="editar('${l.id}')">‚úèÔ∏è Editar</button>
        <button onclick="excluir('${l.id}')">üóë Excluir</button>
      </div>
    `;
    lista.appendChild(div);
  });

  saldoEl.innerText = "Saldo: " + formatar(saldo);
}

/* atalhos DOM */
const tipoInput = document.getElementById("tipo");
const valorInput = document.getElementById("valor");
const descricaoInput = document.getElementById("descricao");
const lista = document.getElementById("lista");
const saldoEl = document.getElementById("saldo");

atualizarTela();
</script>

</body>
</html>
